基本概念

1、	rdt1.0 2.0 2.1 2.2 3.0   			139
2、	CSMA/CD && CSMA/CA			
3、	SR && GBN

4、	DNS 过程
5、	rip && ospf 算法

6、	MTU && MSS
7、	各章节的基本概念，重点概念的小细节。
8、	吞吐量等计算。

## 基础

### 数据交换的分类
1. 分组交换
按需分配链路的使用
优点是利用率高 缺点是可能产生延迟，丢包等，

2. 电路交换
数据传输之前需要建立连接 预留通信所需要的资源 
  频分多路复用 (FDM) 与时分多路复用 (TDM)
  缺点： 当预留的资源没有被使用时，资源利用率较低
### 时延
- 节点处理时延：检查分组头部，路由选择，差错检验等处理时间
- 排队时延：分组交换采用存储转发的模式，当分组到达节点时，在它之前有其他分组正在传输，那它得先缓存排队等待
- 传输时延：将分组的所有比特推向链路花费的时间，L 为分组长度，R 为传输速率，则传输时延为 L/R
- 传播时延：分组被推向链路之后，在链路上传播的时间，传播速度约等于光速
### 

## 应用层

### DNS 协议
分布式的服务器层次结构 
- 根 DNS 服务器
- 顶级 DNS 服务器
- 权威 DNS 服务器
- 本地 DNS 服务器

### 多路复用与多路分解
- 传输层的多路复用是指：多个应用程序将要传递的信息交给传输层，传输层封装信息然后统一交给网络层 
- 传输层的多路分解是指：传输层统一接收来自网络层的数据，提取出各个端口（应用进程）的数据，分发给各个应用进程  
## TCP
RTT:Round Trip Time
RTO:Retransmission TimeOut

Exponential backoff: 超时间隔加倍

timeout retransmissions
fast retransmission

## rdt 
rdt 1.0: 经完全可靠信道的传输

rdt 2.0: 经有比特差错信道的可靠数据传输 
引入了 ACK,NAK
缺陷：没有考虑 ACK NAK 受损的情况

rdt 2.1: 加入序号，用 0 和 1 表示
rdt 2.2：无 NAK，与 2.1 区别：接收方此时必须由一个 ACK 报文所确定的分组序号。发送方必须检查接收到的 ACK 报文中的被确认的分组序号

rdt 3.0：经具有比特差错的丢包信道的可靠数据传输

### 拥塞控制
#### 慢启动
#### 拥塞避免

此时出现超时重传：
1. 把 ssthresh 降低为 cwnd 值的一半

2. 把 cwnd 重新设置为 1

3. 重新进入慢启动过程。

#### 快速重传
1. 把 ssthresh 设置为 cwnd 的一半

2. 把 cwnd 再设置为 ssthresh 的值（具体实现有些为 ssthresh+3)

3. 重新进入拥塞避免阶段。
#### 快速恢复
1. 当收到 3 个重复 ACK 时，把 ssthresh 设置为 cwnd 的一半，把 cwnd 设置为 ssthresh 的值加 3，然后重传丢失的报文段，加 3 的原因是因为收到 3 个重复的 ACK，表明有 3 个“老”的数据包离开了网络。 

2. 再收到重复的 ACK 时，拥塞窗口增加 1。

3. 当收到新的数据包的 ACK 时，把 cwnd 设置为第一步中的 ssthresh 的值。原因是因为该 ACK 确认了新的数据，说明从重复 ACK 时的数据都已收到，该恢复过程已经结束，可以回到恢复之前的状态了，也即再次进入拥塞避免状态。

加性增、乘性减  AIMD

概念题目：
1. SYN、FIN：
TCP 报文段的标志位，表示建立连接，SYN 报文
关闭连接：FIN 比特置为 1.

2. NAT
网络地址转换：NAT 地址表 包含端口号和 IP 地址。
当在专用网内部的一些主机本来已经分配到了本地 IP 地址（即仅在本专用网内使用的专用地址），但现在又想和因特网上的主机通信（并不需要加密）时，可使用 NAT 方法

3. ICMP:
因特网控制报文协议
被主机和路由器用来彼此沟通网络层的信息。ICMP 最典型的用途是差错报告。ICMP 报文是作为 IP 有效载荷承载的。

4. traceroute:
源主机向目的主机发送一系列普通 IP 数据包。这些数据包每个携带了具有一个不可达 UDP 端口号和 UDP 报文段。第一个数据包的 TTL 为 1, 第二个数据包的 TTL 为 2.. 当第 n 个数据包到达第 n 个路由器的时候。第 n 台路由器观察道这个数据报的 TTL 正好过期。路由器丢弃该数据包并发送一个 ICMP 告警报文给源主机。该报文包含了路由器的名字和 IP 地址。如果是目的主机，会发送端口不可达的 ICMP 报文。源主机检测到这个特殊报文就不会再继续发送了。

DHCP：
动态主机配置协议
1. DHCP 服务器发现
2. DHCP 服务器提供
3. DHCP 请求
4. DHCP ack

IPV4 和 IPV6：
IPV6 没有：
1. 分片/重新组装
2. 首部校验和
3. 选项

## 路由器
交换技术
1. 经内存交换
2 经总线交换
一次只有一个分组能够跨越总线。
3. 经互联网络交换

丢包：路由器的缓存空间耗尽，并且当无内存可用于存储到达的分组。

网络层的三个组件：
1. IP 协议
2. 路由选择部分
3. ICMP

###  IP
协议号是将网络层与运输层绑定在一起。
端口号是运输层和应用层绑定到一起的粘合剂。

#### 数据报分片
MTU：一个链路层帧能承载的最大数据量。
MSS（Maximum Segment Size，最大报文长度）

### 多路访问链路和协议 MAC 协议
主要能分为三类：信道划分协议，随机接入协议，轮流协议
#### 信道划分协议

#### 随机接入协议
- 时隙 ALOHA
  将时间划分若干时隙，规定所有人只能在某一个时隙的起始点发送数据
- ALOHA 
  所有人可以在任何时间发送数据 
时隙 ALOHA 的效率比 ALOHA 协议的效率要高一倍左右
- CSMA：载波侦听多路访问
  即发送数据之前先侦听信道，当没有人发送数据时，才发送数据
- CSMA/CD：
  在 CSMA 基础上加了碰撞检测，若检测到碰撞，则都立即停止发送 传播延迟
#### 轮流协议
轮询协议/令牌传递协议

### 链路层寻址和 ARP
数据链路层需要通过 MAC 地址来转发数据帧来通过交换机网络
ARP: 地址解析协议，提供将 IP 地址转化为链路层地址。只为在同一个子网上的主机和路由器接口解析 IP 地址。
1. 查询 ARP 报文是在广播帧中发送的
2. 响应 ARP 报文在一个标准帧中发送
即插即用
工作原理：每台主机或路由器都保存有一张 ARP 表，表中包含 IP 地址与 MAC 地址的映射关系 当表中有目的 IP 地址的信息时，就直接交给链路层进行发送 如果表中还没有相关信息，则在本子网内发送 ARP 广播查询，若此 IP 目的节点收到后应回复一个 ARP 应答报文 所以 ARP 是自适应的，自动建立的，即插即用的

可以认为是跨越链路层和网络层边界两边的协议。

链路层地址：LAN 地址、物理地址、MAC 地址。

### 以太网
以太网是目前有限局域网中具有统治地位的局域网类型 其多路访问控制协议采用 CSMA/CD 协议
### 链路层交换机
链路层交换机所提供的服务是基于 MAC 地址的 交换机的转发与过滤借助于维护一个交换机表，表中有 MAC 地址与端口的对应关系

交换机：链路层
路由器：玩网络层
交换机是自学习的，即自动维护交换机表，即插即用

### CDMA
code division multiple address

### CSMA Carrier Sense Multiple Access 
载波监听多路访问
CSMA/CD 与 CSMA/CA：

### 一个 Web 页面请求全过程
1. 首先需要利用 DNS 域名服务知道 google 服务器的 IP 地址
2. 主机与 google 服务器建立 TCP 连接
3. 主机发送 HTTP GET 报文

题目：

11 年试题：
1. 多路复用
多路复用通常表示在一个信道上传输多路信号或数据流的过程和技术。因为多路复用能够将多个低速信道整合到一个高速信道进行传输，从而有效地利用了高速信道。
通常分为：
  - 时分复用
    高速信道根据时间划分成多个时隙供多个低速信道轮流使用，在一个时隙内，只能有一个低速信道占有高速信道的资源
  - 频分复用
    多路复用器将各个低速信道的信号通过调制分布到高速信道的各个频段，然后进行叠加，形成高速信道上传输的信号，在接收端，分路器一般通过带通滤波器分离各个频段，然后转发给对应的低速信道。
  - 码分复用
    采用扩频通信技术，各个低速信道可以在同一个地方同时使用相同的频率进行通信，不同的低速信道通过采用不同的地址码复用整个频段。
  
2. SYN 表示建立连接
FIN 表示关闭连接

3. NAT 网络地址转换
当在专用网内部的一些主机本来已经分配到了本地 IP 地址（即仅在本专用网内使用的专用地址），但现在又想和因特网上的主机通信（并不需要加密）时，可使用 NAT 方法。

4. 慢启动
慢启动（Slow Start），是传输控制协议（TCP）使用的一种阻塞控制机制。慢启动也叫做指数增长期。慢启动是指每次 TCP 接收窗口收到确认时都会增长。增加的大小就是已确认段的数目。这种情况一直保持到要么没有收到一些段，要么窗口大小到达预先定义的阈值。

如何设计一个可靠数据传输协议：

二维奇偶校验码

检测并纠正一位错误
检测但是并不能纠正两位的错误

解释：RIP、OSFP、BGP 协议，他们主要的不同是什么

CSMA/CD 怎么确定某一时刻的值、 二级制指数后退算法？

比较 CSMA/CS 和 CSMA/CA

计算题：
IP 地址，IP 掩码的理解
创建子网

判断题：
1. SR 协议，选择重传
2. 非持续性连接
3. TCP rwnd
4. IPV6 IPV4

8. 访问 web 服务器涉及到的一系列协议操作

2014 年：
 As an HTTP server is stateless. How does a Web site identify users? Describe the technology HTTP used to solve this problem in detailed.  ：
答：使用 cookie
用户首次访问一个站点时，可能需要提供一个用户标识，在后继会话中。浏览器向服务器传递一个 cookie 首部，从而向改服务器标识了用户。

描述过程：... set cookie 用户浏览器 服务器数据库 ..
P73
2. 


IMAP
因特网邮件访问协议，IMAP 服务器将每个报文与一个文件夹联系起来，
当报文第一次到达服务器时，他是放在收件人的收件箱文件夹里。它为
用户提供了创建文件夹以及在文件夹之间移动邮件，阅读或删除邮件，
在远程文件夹中查询邮件，允许用户代理获取报文组件的命令。
b) Persistent HTTP
持久连接，所有的请求及相应的响应经相同的 TCP 连接发送。在此情况
下，服务器在发送响应后保持该 TCP 连接打开，位于同一台服务器的多
个 web 页面在从该服务器发送给同一个客户，可以在流水线上进行。如
果连接查过一定时间间隔未使用，http 服务器就关闭该连接。
c) Protocol Multiplexing
多路复用，从源主机的不同套接字中收集数据块，并为每个数据块封装
上首部信息，从而生成报文段，然后将报文段传递给网络层。
d) Selective Repeat
选择重传，它通过让发送方仅重传那些他怀疑在接收方出错（即丢失或
受损）的分组而避免了不必要的重传。接收方需要逐个地确认正确接受
的分组。再次用窗口长度 N 来限制流水线中未完成，未被确认的分组数。
e) Network Protocol
交换报文和采取动作的实体是某些设备的硬件或软件组件。


CSMA/CD
见书本。关键词：监听、冲突检测、冲突后退让；退让算法需
提及：随机、指数级增长的上界

路由算法距离向量。

电路交换：
) Call setup required. Dedicated resources, no sharing. Circuit-like performance

链路状态路由计算

虚电路网络：
仅在网络层提供连接服务的计算机网络被称为虚电路网络。（并没有被如今的因特网使用）
在此网络中，该网络的路由器必须为进行中的连接维持连接状态信息。

数据报网络
仅在网络层提供无连接服务的计算机网络被称为数据报网络。

DHCP（Dynamic Dynamic Dynamic Dynamic Host Configuration Configuration Configuration Configuration Protocol Protocol Protocol Protocol）动态主机配置协议 ）动态主机配置协议 ）动态主机配置协议 ）动态主机配置协议
主机可以自动获取 IP 地址，即插即用协议。
DHCP 的四个步骤：
①DHCP 服务器发现 ②DHCP 服务器提供 ③DHCP 请求 ④DHCP ACK

NAT(Network NAT(Network NAT(Network NAT(Network Address Address Address Address Translation) Translation) Translation) Translation)网络地址转换
NAT 网关进行外部 IP 地址和内部专有地址之间的转换，实现了子网内部的主机共享一 个
IP 地址的功能。子网内部的每一台主机都拥有一个专有的 IP 地址，NAT 网关根据数 据 包 的
端口号来区别子网内的主机，每个 NAT 网关都有一个 NAT 映射表，实现外部地址和内部地址的
转换

ICMP（Internet Internet Internet Internet Control Control Control Control Message Message Message Message Protocol Protocol Protocol Protocol）互联网控制报文协议 ）互联网控制报文协议 ）互联网控制报文协议 ）互联网控制报文协议
Traceroute 是利用 TTL 和 ICMP 机制实现。
通过不断地向目的地（选择一个不常用的端口）发 UDP 包，TTL 依次设为 1,2,3…每次 TTL
到期，路由器都会返回一个 ICMP 包报错，并告诉发送方自己的信息。这样每发一 个 UDP 包
就认识路径中的一个路由器，直到最后 UDP 到达目的主机，因为端口号不存 在，返回最后一
个 ICMP 包。如此便知道了起点到终点的路径。

 地址解析协议（ 地址解析协议（Address Address Address Address Resolution Resolution Resolution Resolution Protocol Protocol Protocol Protocol，ARP）
ARP 只为在同一个子网上的节点解析 IP 地址。每一个节点（主机，路由）都有一张 ARP 表。
当 A 要发报文给 B 时，B 的 MAC 地址不在 A 的 ARP 表中：
①A 广播 ARP 查询报文，包含 B 的 IP 地址
②B 将收到 ARP 报文，并回复一个 ARP 响应报文，包含自己的 MAC 地址
③A 将 B 的 IP 地址和 MAC 地址的映射保存在自己的 ARP 表中

4) CSMA/CD 
工作方式：
①适配器从网络层得到一个数据报，创建以太网帧；
②如果新到空闲，则开始传输此帧，如果忙就等待；
③如果输送过程没有检测到其他传输，即完成了；
④如果检测到其他传输，则立即停止，传送一个阻塞 jam 信号；
⑤中止传输后，适配器指数后退，选 0~2
n-1 中的随机数 K，等待 K*512 的时间，再重复步
骤②。

4) CSMA/CA 带碰撞避免的 CSMA
CSMA 代表“载波侦听多路访问”，意味着每个站点在传输之前监听信道，一旦侦听到该信道
忙则抑制传输。
工作方式：
假设一个站点（无线站点或 AP），有一个帧要发送 【AP：Access Point 访问接入点】
①如果初始时监听到信道空闲，它将在一个被称为分布式帧间间隔（Distributed Inter-Frame
Space，DIFS）的短时间后发送
②否则该站点选取一个随机回退值，并且在侦听信道空闲时递减该值，若信道忙则保持不变。
③当计数器键位 0 时，该站点发送整个数据帧并等待确认。接收方在接收到某一帧后，会等待一
个短帧间间隔（SIFS）后才发送确认。
④如果收到确认，则正常接收了，要再继续发送就从步骤②开始。若未收到确认，则发送方重新
进入步骤②，选择一个更大的回退值。

     1.CSMA/CD媒体访问控制协议

　　由于以太网（Ethernet）成为现存局域网络结构的绝大多形式，CSMA/CD（Carrier Sense Multiple ACcess/Collision Detection）载波监测多址接人协议也成为局域网采用最多的MAC协议。CSMA/CD适宜于总线型局域网拓扑结构的随机竞争型媒体访问控制。总线型网络允许同一时刻只有一个节点（Node）发送数据，一旦两个或以上节点同时发送数据，则会发生数据碰撞，数据不能正常发送和接收。CSMA/CD协议就是尽可能保证网络上同时只有一个节点发送数据，减小数据“碰撞”概率。

　　CSMA/CD工作过程：

　　当MAC收到LLG发来的数据以后，首先监测网络电缆上是否具有数据，即载波传送。如果网络空闲，即没有载波传送，则将数据装帧，经物理层发送出去。如果网络繁忙，则监测网络直到网络空闲，再将数据装帧发送。

发送数据前 先侦听信道是否空闲 ,若空闲 则立即发送数据.在发送数据时,边发送边继续侦听.若侦听到冲突,则立即停止发送数据.等待一段随机时间,再重新尝试.

　　先听后发，边发边听，冲突停发，随即延迟后重发
　　2.CSMA/CA协议

　　CSMA作为随机竞争类MAC协议，具算法简单而且性能丰富，所以在实际局域网的使用中得到了广泛的应用。但是在无线局域网中，由于无线传输媒体固有的特性及移动性的影响，无线局域网的MAC在差错控制、解决隐藏终端等方面存在应有别于有线局域网。因此WLAN与有线局域网所采用的CSMA备一定的差异。WLAN采用CSMA/CA（CSMA/Collision　Avoidance）协议，其与CSMA/CD最大的不同点在于其采取避免冲突工作方式。

　　与CSMA/CD不同，WLAN媒体访问控制（MAC）层采用的CSMA/CA（CSMA/Collision Avoidance）协议，由于在RF传输网络中冲突检测比较困难，所以该协议用避免冲突检测代替802.3协议使用的冲突检测，采用冲突避免机制尽量减小冲突碰撞发生的概率，以提高网络吞吐性能与迟延性能。协议使用信道空闲评估（CCA）算法来决定信道是否空闲，通过测试天线能量和决定接收信号强度RSSI来完成，并且使用RTS、CTS和ACK帧减少冲突。数据加密与普通局域网的等同加密（WEP）算法一样，使用64位密钥和RC4加密算法。

　　CSMA/CA工作过程

　　当发射端希望发送数据时，首先检测介质是否空闲，若是介质为空闲时，送出RTS（Request To Send请求发送），RTS信号包括发射端的地址、接收端的地址、下一笔数据将持续发送的时间等信息，接收端收到RTS信号后，将响应短信号CTS（Clear To Send），CTS信号上也RTS内记录的持续发送的时间，当发射端收到CTS包后，随即开始发送数据包。接收端收到数据包后，将以包内的CRC（CyClic Redundancy Check，循环冗余校验）的数值来检验包数据是否正确，若是检验结果正确时，接收端将响应ACK包，告知发射端数据己经被成功地接收。当发射端没有收到接收端的ACK包时，将认为包在传输过程中丢失，而一直重新发送包。
CSMA/CA：带有冲突避免的载波侦听多路访问，发送包的同时不能检测到信道上有无冲突，只能尽量‘避免’；

CIDR（无类别域间路由，Classless Inter-Domain Routing）是一个在Internet上创建附加地址的方法，这些地址提供给服务提供商（ISP），再由ISP分配给客户。4

8） (15points) CSMA/CA
a) What is CSMA/CA?
b) Why WIFI uses CSMA/CA?
c) How CSMA/CA works?


FDM:
TDM:
BGP:
PPP
MAC 介质访问控制

点对点协议（英语：Point-to-Point Protocol，PPP）工作在数据链路层（以OSI参考模型的观点）。它通常用在两节点间创建直接的连接，并可以提供连接认证、传输加密（使用ECP，RFC 1968）以及压缩。

**（1）递归查询**
递归查询是一种DNS 服务器的查询模式，在该模式下DNS 服务器接收到客户机请求，必须使用一个准确的查询结果回复客户机。如果DNS 服务器本地没有存储查询DNS 信息，那么该服务器会询问其他服务器，并将返回的查询结果提交给客户机。
**（2）迭代查询**
DNS 服务器另外一种查询方式为迭代查询，DNS 服务器会向客户机提供其他能够解析查询请求的DNS 服务器地址，当客户机发送查询请求时，DNS 服务器并不直接回复查询结果，而是告诉客户机另一台DNS 服务器地址，客户机再向这台DNS 服务器提交请求，依次循环直到返回查询的结果

**Compare checksums and CRCs as a means of detecting errors. Discuss the tradeoffs between checksums and CRCs.**
 5.	Checksums have a greater probability of undetected errors than do CRCs. That is, CRCs are better at detecting errors and will result in less undetected errors than checksums. CRCs are easily be computed in hardware, but not very easily in software. Checksums can be computed in software much faster than can CRCs.


DNS, TCP/UDP, IP, MAC in network and link layers is acceptable. 

1.传输层的功能
（1）提供应用程序间 的逻辑通信。

（2）差错检测

对收到报文的首部和数据部分都进行差错检测。

（3）提供无连接的或面向连接的服务

UDP,TCP

（4）复用和分用

复用指发送方不同的应用程序都可以使用同一个传输层协议传送数据。

分用指接收方的传输层在剥去报文的首部后能够把这些数据正确的交付到目的应用程序。

面向连接服务还有以下两个功能

（1）连接管理

如TCP的三次握手

（2）流量控制和拥塞控制

以对方和网络普遍接受的速度发送数据，从而防止网络拥塞造成数据的丢失。



网络层提供的服务：
主机到主机
路由 转发 连接管理

分层选路：
广播和多播：

二、 广播： 

主机之间“一对所有”的通讯模式，网络对其中每一台主机发出的信号都进行无条件复制并转发，所有主机都可以接收到所有信息（不管你是否需要），由于其不用路径选择，所以其网络成本可以很低廉。有线电视网就是典型的广播型网络，我们的电视机实际上是接受到所有频道的信号，但只将一个频道的信号还原成画面。在数据网络中也允许广播的存在，但其被限制在二层交换机的局域网范围内，禁止广播数据穿过路由器，防止广播数据影响大面积的主机。 

三、组播： 

主机之间“一对一组”的通讯模式，也就是加入了同一个组的主机可以接受到此组内的所有数据，网络中的交换机和路由器只向有需求者复制并转发其所需数据。**主机可以向路由器请求加入或退出某个组**，网络中的路由器和交换机有选择的复制并传输数据，即只将组内数据传输给那些加入组的主机。这样既能一次将数据传输给多个有需要（加入组）的主机，又能保证不影响其他不需要（未加入组）的主机的其他通讯。 

OSPF属于IGP协议，是链路状态路由协议，一般运行在AS自治系统内部，采用SPF算法保证了在AS内部不会产生环路。由于OSPF协议时每台路由器自身计算出来的，所以过滤路由非常麻烦。
BGP属于EGP协议，是距离矢量路由协议，在设计考虑到可能形成环路问题，故此为BGP添加了许多属性保证不会产生环路，通常应用在AS之间，用于互联网选路的协议，可以通过更改BGP属性来影响路由选路问题，BGP本身不计算路由，因此依靠引路其他路由，所以过滤路由是比较方便地，而且依靠BGP属性的应用，很容易实现数据分流。 

1. A类地址

  A类地址的表示范围为：0.0.0.0~126.255.255.255，默认网络掩码为：255.0.0.0；A类地址分配给规模特别大的网络使用。A类网络用第一组数字表示网络本身的地址，后面三组数字作为连接于网络上的主机的地址。分配给具有大量主机（直接个人用户）而局域网络个数较少的大型网络。例如IBM公司的网络。

  2. B类地址

B类地址的表示范围为：128.0.0.0~191.255.255.255，默认网络掩码为：255.255.0.0；B类地址分配给一般的中型网络。B类网络用第一、二组数字表示网络的地址，后面两组数字代表网络上的主机地址。

  3. C类地址

  C类地址的表示范围为：192.0.0.0~223.255.255.255，默认网络掩码为：255.255.255.0；C类地址分配给小型网络，如一般的局域网和校园网，它可连接的主机数量是最少的，采用把所属的用户分为若干的网段进行管理。C类网络用前三组数字表示网络的地址，最后一组数字作为网络上的主机地址。

要看的：各个层提供的服务
可靠数据传输
拥塞控制
复习 csma/cd 
路由算法的比较
流量控制

